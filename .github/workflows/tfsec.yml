name: tfsec

on: [push]

jobs:
  tfsec:
    name: Run tfsec sarif report
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Run tfsec
        uses: aquasecurity/tfsec-sarif-action@v0.1.4
        with:
          sarif_file: tfsec-report.sarif
          full_repo_scan: true

      - name: Upload SARIF file
        uses: actions/upload-artifact@v3
        if: always()
        with:
          name: tfsec-findings
          path: tfsec-report.sarif
